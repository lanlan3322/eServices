<!--
company.html - edit company table
Copyright (C) 2004 R. James Holton

This program is free software; you can redistribute it and/or modify it 
under the terms of the GNU General Public License as published by the 
Free Software Foundation; either version 2 of the License, or (at your option) 
any later version.  This program is distributed in the hope that it will be 
useful, but WITHOUT ANY WARRANTY; without even the implied warranty of 
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General 
Public License for more details.

You should have received a copy of the GNU General Public License along with 
this program; if not, write to the Free Software Foundation, Inc., 
675 Mass Ave, Cambridge, MA 02139, USA. 
-->

<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Expense Type Editor</title>
<link rel="stylesheet" href="../expense.css" type="text/css"></head>

<body onLoad="javascript: void fillForm()">
<big><big>

<p><h1>Company Code Editor</h1></p>

<form method="post" action="edit/SubmitEdit.jsp" onSubmit="return updateValues()">
  <input type="hidden" name="screenname" value> 
  <input type="hidden" name="xaction" value>
  <input type="hidden" name="email" value>
  <input type="hidden" name="ccode" value>
  <input type="hidden" name="database" value>
  <input type="hidden" name="LANGUAGE" value>
  <table border="0" width="100%" bordercolor="#FFFFFF" bordercolorlight="#FFFFFF" bordercolordark="#FFFFFF" cellspacing="1" cellpadding="0">
    <tr>
      <td width="25%"><div class="ExpenseTag">Company ID:</div></td>
      <td width="75%"><script>parent.main.document.write("<input type=\"text\" name=\"COMPANY\" size=\"18\" onChange=\"add2Lists()\"" + parent.contents.setKeyField("ProtectedField") +  " essType=\"String\" essRequired=\"yes\" maxLength=\"18\" essTitle=\"Company ID\">")</script></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Description:</td>
      <td width="75%" bordercolor="#FFFFFF" bordercolorlight="#FFFFFF" bordercolordark="#FFFFFF" class="offsetColor"><input type="text" name="DESCRIP" size="30" maxLength="30"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Default Guideline:</td>
      <td width="75%"><select name="GUIDE" size="1" essTitle="Guideline List" essType="List" >
      </select> </td>
    </tr>
    
    <tr>
      <td width="25%" class="ExpenseTagOffset">Profile Active:</td>
      <td width="75%" class="offsetColor"><select name="ACTIVE" size="1">
        <option selected>Yes</option>
        <option>No</option>
      </select> </td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">GL Code:</td>
      <td width="75%"><input type="text" name="GL_COMPANY" size="8" essType="String" essMinimum="0" essTitle="GL Code" maxLength="8"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Home Currency:</td>
      <td width="75%" class="offsetColor"><select name="CURRENCY" size="1"></select></td>
    </tr>
    
    <tr>
      <td width="25%" class="ExpenseTag">Parent Frame Name:</td>
      <td width="75%"><input type="text" name="PARENT" value="ess-app/Report.jsp" size="30" essType="String" essMinimum="1" essTitle="Parent Frame" maxLength="100"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Logo File Name:</td>
      <td width="75%" class="offsetColor"><input type="text" name="LOGOFILE" size="30" essType="String" essMinimum="1" essTitle="Logo File" maxLength="100"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Logo Height:</td>
      <td width="75%"><input type="text" name="HEIGHT" size="3" essType="String" essMinimum="1" essTitle="Logo Height" maxLength="3"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Logo Width:</td>
      <td width="75%" class="offsetColor"><input type="text" name="WIDTH" size="3" essType="String" essMinimum="1" essTitle="Logo Width" maxLength="3"></td>
    </tr>
    
    <tr>
      <td width="25%" class="ExpenseTag">Travel Units:</td>
      <td width="75%"><select name="UNITS" size="1" essTitle="Unit List" essType="List" >
        <option selected>Miles</option>
        <option>Kilometers</option>
        <option>Cost</option>
        <option>Pers_Miles</option>
        <option>Pers_Kms</option>
        <option>Gallons</option>
      </select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Offset Element:</td>
      <td width="75%" class="offsetColor"><input type="text" name="OFFSETS" size="20" essType="String" essMinimum="3" essTitle="Offset Element" maxLength="20" value="generaloffset"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Step Element:</td>
      <td width="75%"><input type="text" name="STEPS" size="20" essType="String" essMinimum="2" essTitle="Step Element" maxLength="20" value="steps"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Primary Auditor:</td>
      <td width="75%" class="offsetColor"><input type="text" name="AUDITOR" size="12" essType="String" essMinimum="1" essTitle="Primary Auditor" maxLength="12">
      <a class="ExpenseLink" href="javascript:doNothing()" onClick="clickUser()" ><sm><em>Lookup!</em></sm></a>
      </td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Language:</td>
      <td width="75%"><select name="languagename" size="1">
            <option value = "en" selected>English</option> 
            <option value = "fr" >French</option>
      </select>
    </td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">SIC Mapping:</td>
      <td width="75%" class="offsetColor"><input type="text" name="MAPPING" size="30" essType="String" essMinimum="1" essTitle="SIC Mapping" maxLength="100"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Payroll Code:</td>
      <td width="75%"><input type="text" name="PAYROLL" size="3" essType="String" essMinimum="3" essTitle="Payroll Code" maxLength="3"></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Purpose Screen:</td>
      <td width="75%" class="offsetColor"><input type="text" name="PURPOSESCREEN" size="30" essType="String" essMinimum="1" essTitle="Legacy Purpose Screen" maxLength="30" value="head2j.html"></td>
    </tr>
    <tr>
    	<td width="25%" class="ExpenseTag">Entry Screen:</td>
    	<td width="75%"><input type="text" name="ENTRYSCREEN" size="30" essType="String" essMinimum="1" essTitle="Entry Screen" maxLength="30" value="screenDemo.html"></td>
   </tr>
   <tr>
   		<td width="25%" class="ExpenseTagOffset">Hotel Screen:</td>
   		<td width="75%" class="offsetColor"><input type="text" name="HOTELSCREEN" size="30" essType="String" essMinimum="1" essTitle="Hotel Screen" maxLength="30" value="trans12fxnj.html"></td>
   	</tr>
    <tr>
    <td width="25%" class="ExpenseTag">&nbsp;</td>
    <td width="75%">&nbsp;</td>
    </tr>

    <tr>
      <td width="25%" class="ExpenseTagOffset">&nbsp;</td>
      <td width="75%" class="offsetColor">&nbsp;</td>
    </tr>
    
    <tr>
      <td width="25%" class="ExpenseTag"><u>Power Lists</u></td>
      <td width="75%"><small>Specify Company to "borrow" that list.  Most lists inherit (i.e., combine self and specified company). The mileage list will not inherit, but will completely replace.</small></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Client List:</td>
      <td width="75%" class="offsetColor"><select name="CLIENT" size="1" essTitle="Client List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Expense Type List:</td>
      <td width="75%"><select name="EXPENSE" size="1" essTitle="Expense Type List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Payment Method List:</td>
      <td width="75%" class="offsetColor"><select name="PAYMENT" size="1" essTitle="Payment Method List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Merchant List:</td>
      <td width="75%"><select name="MERCHANT" size="1" essTitle="Merchant List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Location List:</td>
      <td width="75%" class="offsetColor"><select name="LOCATION" size="1" essTitle="Location List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTag">Project List:</td>
      <td width="75%"><select name="PROJECT" size="1" essTitle="Project List" essType="List" ></select></td>
    </tr>
    <tr>
      <td width="25%" class="ExpenseTagOffset">Mileage List:</td>
      <td width="75%" class="offsetColor"><select name="MILEAGE" size="1" essTitle="Mileage List" essType="List" ></select><small>&nbsp;&nbsp;Replaces/Not inherited</small></td>
    </tr>
    
  </table>
  <p><input type="submit" value="OK - Accept any Changes" name="btn"></p>
</form>
<p align="right"><a class="ExpenseReturnLink" href="javascript: void history.go(-1)">Return to previous screen</a></p>
<script LANGUAGE="JavaScript" SRC="../calendar.js"></script>
<script LANGUAGE="JavaScript" SRC="../validation.js"></script>
<script LANGUAGE="JavaScript" SRC="../addmerchant.js"></script>
<script language="Javascript">


function clickUser() {
  setLocalJsp(document.forms[0].AUDITOR,"UserPersNum",900,300);
  MerchantType = 'user';
}

function fillForm() {
  parent.contents.setList(document.forms[0].CURRENCY, parent.contents.getCurrencies("1"));

  try {  //encase there is no company, one can be created
     parent.contents.setList(document.forms[0].GUIDE, parent.contents.getGuidelineGroups("1"));               
  
     parent.contents.setList(document.forms[0].CLIENT, parent.contents.getCompanies("1"));
     parent.contents.setList(document.forms[0].EXPENSE, parent.contents.getCompanies("1"));               
     parent.contents.setList(document.forms[0].PAYMENT, parent.contents.getCompanies("1"));               
     parent.contents.setList(document.forms[0].MERCHANT, parent.contents.getCompanies("1"));               
     parent.contents.setList(document.forms[0].LOCATION, parent.contents.getCompanies("1"));               
     parent.contents.setList(document.forms[0].MILEAGE, parent.contents.getCompanies("1")); 
     parent.contents.setList(document.forms[0].PROJECT, parent.contents.getCompanies("1"));              
  } catch (x) {
     alert("Error in table load");
  }
     
 
  if (parent.contents.isNew())
  {
    document.forms[0].xaction.value = "INSERT";
  } else {
    parent.contents.setTransaction(document.forms[0]);
    parent.contents.setListDfltWVal(document.forms[0].languagename,document.forms[0].LANGUAGE.value);
    document.forms[0].xaction.value = "UPDATE";
    parent.contents.ListBuffer.length = 0;
  }
  document.forms[0].COMPANY.focus();
  document.forms[0].action = parent.contents.defaultApps + "edit/SubmitEdit.jsp";
  document.forms[1].action = parent.contents.defaultApps + "edit/EditList.jsp";
}

function add2Lists(x,y) {
  addSingle(document.forms[0].CURRENCY, document.forms[0].COMPANY);
  addSingle(document.forms[0].CLIENT, document.forms[0].COMPANY);
  addSingle(document.forms[0].EXPENSE, document.forms[0].COMPANY);               
  addSingle(document.forms[0].PAYMENT, document.forms[0].COMPANY);               
  addSingle(document.forms[0].MERCHANT, document.forms[0].COMPANY);               
  addSingle(document.forms[0].LOCATION, document.forms[0].COMPANY);               
  addSingle(document.forms[0].MILEAGE, document.forms[0].COMPANY); 
  addSingle(document.forms[0].PROJECT, document.forms[0].COMPANY);              
}

function addSingle(x,y) {
   x.options.length = x.options.length + 1;
   x.options[x.options.length - 1].text = y.value;
}

function updateValues() {
  if (checkAllFields(document.forms[0]))
  {
    document.forms[0].LANGUAGE.value = document.forms[0].languagename.options[document.forms[0].languagename.selectedIndex].value;
    document.forms[0].screenname.value = "company";
    document.forms[0].email.value = parent.contents.getNameValue(parent.Header, "email");
    document.forms[0].database.value = parent.database;
    document.forms[0].ccode.value = parent.CCode;
    return true;
  } else {
    return false;
  }
}

</script>

  <form method="POST" action="edit/EditList.jsp" onSubmit="SubmitSearch()">
    <h2>Access the central database for:&nbsp;
    <input type="submit" value= "Company Codes" name="Search"></h2>
    <input type="hidden" name="screenname" value> 
    <input type="hidden" name="email" value>
    <input type="hidden" name="ccode" value>
    <input type="hidden" name="database" value>
  </form>
  <script language="JavaScript">
  function SubmitSearch() {
    with(document.forms[1]) {
       screenname.value = "company";
       email.value = parent.contents.getNameValue(parent.Header, "email");
       database.value = parent.database;
       ccode.value = parent.CCode;
       return true;  
    }
  }
  </script>




</body>
</html>
