<!--
addgeneral.html - Add an information string (i.e., currently merchants)   
Copyright (C) 2004 R. James Holton

This program is free software; you can redistribute it and/or modify it 
under the terms of the GNU General Public License as published by the 
Free Software Foundation; either version 2 of the License, or (at your option) 
any later version.  This program is distributed in the hope that it will be 
useful, but WITHOUT ANY WARRANTY; without even the implied warranty of 
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General 
Public License for more details.

You should have received a copy of the GNU General Public License along with 
this program; if not, write to the Free Software Foundation, Inc., 
675 Mass Ave, Cambridge, MA 02139, USA. 
-->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Add Merchant</title>
<link rel="stylesheet" href="expense.css" type="text/css">
</head>

<body onLoad="FormInit()">

<form>
<table border="0" cellpadding="0" cellspacing="0" width="100%">

	<tr>
		<td width="100%" class="bannerColor">
		<p align="center">
		<div class="ExpenseTag"><em>Add to your list:</em></div>
		</td>
	</tr>
	<td width="20%" class="offsetColor">
	<center><select name="expensetype" size="1" tabindex="6">
	</select></center>
	</td>
	<tr>
		<td width="100%" align="center">
		<center>
		<p><input type="text" name="merchant" size="25"></p>
		</center>
		<p><input type="button" value="Add to list" name="OK"
			onClick="JavaScript: void addMerchant()"> <input
			type="button" value="Cancel" name="Cancel" onClick="window.close()"></p>
		</td>
	</tr>

</table>
</form>
<script LANGUAGE="JavaScript">
function addMerchant(){
  if (document.forms[0].merchant.value > " ") {
    window.opener.setLocalMerchant(document.forms[0].merchant.value);
    window.close();
  }
}
function FormInit(){
  window.opener.parent.contents.setList(document.forms[0].expensetype, window.opener.parent.contents.getExpenseTypes(window.opener.parent.Category));
  var z = true;
  var j = 0;
  do {
    if (document.forms[0].expensetype.options[j].text == !!!!!!) {
      document.forms[0].expensetype.selectedIndex = j;
      z = false;
    }
    j = j + 1;
  } while (z && j < document.forms[0].expensetype.length); 
  window.focus();
  window.onresize = hdleResize;
}

function hdleResize() {
//  note that ns6 also supports : body.clientWidth/Height 
  var x = 0;
  var y = 0;
  if (document.documentElement.clientWidth && document.documentElement.clientWidth != 0) {
    x = document.documentElement.clientWidth;  //IE 6 standard
    y = document.documentElement.clientHeight;
  } else if (document.body.clientWidth && document.body.clientWidth != 0) {
    x = document.body.clientWidth;  // IE quirkie mode
    y = document.body.clientHeight;
  } else if (window.innerWidth && window.innerWidth != 0) {
    x = window.innerWidth;  // NS
    y = window.innerHeight;
  }
  
  if(opener.parent.main.MerWinSize && opener.parent.main.MerWinSize != null) { 
    opener.parent.main.MerWinSize(x,y);
  }
}

</script>
</body>
</html>
